
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="nav"><div>Next: <a href='十四、实验楼用户评论文本情感分析.html'>十四、实验楼用户评论文本情感分析</a>, Up: <a href='index.html'>Index</a></div></div>
      <div id="titlearea">
        <h2>十五、实验楼用户购买会员行为预测</h2>
      </div>
      <div id="contentarea"><div class="cell text-cell"><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">本实验为实验楼训练营课程 《Python 数据分析入门与进阶》的第十节，在该章节中我们将根据用户产生的数据对实验楼潜在的会员用户（可能产生购买会员的行为）进行预测。</p><h2 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">实验楼潜在会员用户预测</h2><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">如今，越来越多的用户开始购买实验楼的会员服务，享受最为完整的线上实验操作体验。但是，实验楼的一位注册用户是否购买会员的行为应该是建立在一定背景条件下。相信很少有用户刚刚完成注册不久，就直接购买会员。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">比如，用户 A 在实验楼上学习了越来越多的免费课程，并对会员课程蠢蠢欲动。所以，他决定付费购买会员。或者像用户 B 通过不断地在线练习，积累了大量的实验豆。而实验豆正好可以抵扣一部分会员费用。于是打算购买会员服务。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">一般来讲，促使付费行为发生的原因，往往都建立在用户的活跃度之上。没有足够的了解，也就没有足够强烈的付费意愿。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">这一次，我们提供了实验楼用户的真实采样数据，你可以通过下面链接下载该数据。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs " style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;">wget <span class="hljs-symbol" style="box-sizing: border-box; color: rgb(102, 217, 239);">http:</span>/<span class="hljs-regexp" style="box-sizing: border-box; color: rgb(174, 129, 255);">/labfile.oss.aliyuncs.com/courses</span><span class="hljs-regexp" style="box-sizing: border-box; color: rgb(174, 129, 255);">/764/data</span>_10.zip

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 解压</span>
unzip data_10.zip
.
├── user_fit.xlsx
└── user_prediction.xlsx

</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_fit.xlsx</code>&nbsp;数据集包含有&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">8</code>&nbsp;个特征项，以及用户是否为会员的标签，数据共计&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">40000</code>条。预览如下：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/33A544EA2B140DBE778A2068776C6E61.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="837" height="257"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_prediction.xlsx</code>数据集包含&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">10000</code>&nbsp;条数据，且数据特征项与&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_fit.xlsx</code>&nbsp;完全一致。唯一<span style="box-sizing: border-box; font-weight: 600;">不同</span>的地方在于，<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_fit.xlsx</code>&nbsp;中既有会员数据也有非会员数据，而&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_prediction.xlsx</code>&nbsp;数据集中全部都为非会员用户。预览如下：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/307EDC9D01D5C735C0996F2B834FAA1C.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="834" height="258"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">数据集已经做过相应的预处理工作，没有缺失值。最后一项会员标签，通过布尔值进行标识。<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">True</code>当前用户是会员身份，<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">False</code>&nbsp;代表当前用户不是会员身份。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">下面，我们想使用&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_fit.xlsx</code>&nbsp;数据集训练一个预测模型，用于预测&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_prediction.xlsx</code>&nbsp;非会员数据集中，有哪一些可能是潜在的会员用户。</p><h2 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">朴素贝叶斯求用户是潜在会员的概率</h2><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">朴素贝叶斯是一种可用于构建分类模型的方法，他是假设特征相互独立的情况下，运用贝叶斯定理进行后验概率计算的简单分类器。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们先看一下贝叶斯定理。贝叶斯定理由英国数学家托马斯·贝叶斯命名，它是描述随机事件条件概率的一则定理。公式如下：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/775F344608716EC6595374B82A35A47C.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="279" height="46"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">其中：</p><ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; padding-left: 2em; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><li style="box-sizing: border-box;"><p style="box-sizing: border-box; margin: 16px 0px;"><code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">P(A)</code>被称之为&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">A</code>&nbsp;的先验概率，也就是&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">A</code>事件在不考虑<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">B</code>&nbsp;因素条件下发生的概率。</p></li><li style="box-sizing: border-box; margin-top: 0.25em;"><p style="box-sizing: border-box; margin: 16px 0px;"><code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">P(A|B)</code>&nbsp;是在&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">B</code>&nbsp;事件发生的情况下<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">A</code>&nbsp;事件发生的可能性，也被称作&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">A</code>&nbsp;的后验概率。</p></li></ul><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">同理，<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">P(A)</code>&nbsp;和&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">P(A|B)</code>&nbsp;的含义应该就很清楚了。如果你对概率论不太了解。那么，我们结合着本实验的数据集来解释。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们的数据集拥有&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">8</code>个特征值，分别为：<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">用户的注册时间、用户的学习时间 用户实验豆数量、学习的课程数量、学习的实验数量、学习训练营数量 用户的提问数量、用户的评论数量</code>。这些特征之间是相互独立的。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">而这些特征可能会对最后的目标参数，也就是该用户是否为会员造成影响。也就是说，如果我们现在有一个会员的数据，我们知道他的&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">8</code>&nbsp;个特征取值，最后想了解他成为会员的概率有多大？</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">根据贝叶斯定理：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">P(A|B) = P(B|A) P(A) / P(B)</code></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">也就是说（这里只选择前两个特征，以方便描述）：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">P(<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">会员</code>|&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">用户的注册时间 x 用户的学习时间</code>) = P(<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">用户的注册时间 x 用户的学习时间</code>&nbsp;|&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">会员</code>) x P(<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">会员</code>) / P(<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">用户的注册时间 x 用户的学习时间</code>)</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们认为特征之间是相互独立的。所以：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">P(<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">会员</code>|&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">用户的注册时间 x 用户的学习时间</code>) = P(<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">用户的注册时间</code>&nbsp;|&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">会员</code>) x (<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">用户的学习时间</code>&nbsp;|&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">会员</code>) x P(<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">会员</code>) / P(<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">用户的注册时间</code>) x P(<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">用户的学习时间</code>)</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">那么，像 P(<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">用户的注册时间</code>) 这样的概率 怎样求解呢？由于我们这里是连续变量，一般会针对其进行离散化处理，也就是通过假定一个区间，计算变量落在该区间内的概率。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">最后，我们就可以计算出该用户是会员和不是会员的概率，通过比较得出分类属性。</p><h4 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">模型实现</h4><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">为了帮助初学者，我们这里直接使用&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">scikit-learn</code>&nbsp;提供的贝叶斯算法来构建模型，从而降低自行构建模型的复杂程度。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">scikit-learn</code>&nbsp;针对朴素贝叶斯提供了三种分类器，分别是：</p><ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; padding-left: 2em; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><li style="box-sizing: border-box;">高斯分布朴素贝叶斯分类器&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">naive_bayes.GaussianNB</code></li><li style="box-sizing: border-box; margin-top: 0.25em;">多项式分布朴素贝叶斯分类器&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">naive_bayes.MultinomialNB</code></li><li style="box-sizing: border-box; margin-top: 0.25em;">伯努利分布朴素贝叶斯分类器&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">naive_bayes.BernoulliNB</code></li></ul><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">其中，高斯分布模型常用于特征值为连续型变量的数据集中，例如本实验中的数据集。高斯模型的特点在于它通常假设是这些连续数值为高斯分布，相比于直接把连续变量离散化的方法更优。伯努利模型常用处理特征变量为布尔值类型的数据集，多项式模型常用于文本分类。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">下面，我们先尝试使用高斯分布朴素贝叶斯针对&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_fit.xlsx</code>&nbsp;数据集构建一个分类模型。代码非常简单。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs " style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;"><span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># -*- coding: utf-8 -*-</span>

<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> pandas as pd
from sklearn.model_selection <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> train_test_split
from sklearn.naive_bayes <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> GaussianNB

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用 Pandas 读取数据</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">df</span> = pd.read_excel(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"user_fit.xlsx"</span>, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">header=0)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 特征</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">x</span> = df.iloc[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>:<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">8</span>]

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 目标</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">y</span> = df['用户是否为会员']

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 安装 3:7 切分验证集和训练集</span>
train_x, test_x, train_y, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">test_y</span> = train_test_split(x, y, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">test_size=0.3)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 构建高斯贝叶斯分类器</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">model_GaussianNB</span> = GaussianNB()

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用训练集训练模型</span>
model_GaussianNB.fit(train_x, train_y)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用验证集评估准确度</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">score</span> = model_GaussianNB.score(test_x, test_y)

print(score)
</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">经过测试，得到了大约<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">92.7%</code>的准确率，结果还能接受。当然，由于数据会随机分配，你的预测准确率可能会有些许出入。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/1D8E502179DE5A86923F869D7028713E.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="495" height="66"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">接下来，我们使用&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_fit.xlsx</code>&nbsp;全部数据用于训练模型，并将模型保存为二进制文件。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs " style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;"><span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># -*- coding: utf-8 -*-</span>

<span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> pandas <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">as</span> pd
<span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">from</span> sklearn.naive_bayes <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> GaussianNB
<span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">from</span> sklearn.externals <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> joblib

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用 Pandas 读取数据</span>
df = pd.read_excel(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"user_fit.xlsx"</span>, header=<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 特征</span>
x = df.iloc[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>:<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">8</span>]

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 目标</span>
y = df[<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">'用户是否为会员'</span>]

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 构建高斯贝叶斯分类器</span>
model_GaussianNB = GaussianNB()

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用训练集训练模型</span>
model_GaussianNB.fit(x, y)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 保存模型</span>
joblib.dump(model_GaussianNB, <span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">'model_GaussianNB.pkl'</span>)

<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">print</span>(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">'done.'</span>)
</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">然后，你就能看到我们的二进制模型文件。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/420D36E200A8182B043127F412A38ACB.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="423" height="279"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">接下来，我们使用该模型去评估&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_prediction.xlsx</code>&nbsp;非会员数据集中，潜在会员用户的概率。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs " style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;"><span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># -*- coding: utf-8 -*-</span>

<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> pandas as pd
<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> numpy as np
from sklearn.externals <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> joblib

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用 Pandas 读取数据</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">df</span> = pd.read_excel(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"user_prediction.xlsx"</span>, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">header=0)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 特征</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">x</span> = df.iloc[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>:<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">8</span>]

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 加载模型</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">model_GaussianNB</span> = joblib.load('model_GaussianNB.pkl')

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 返回预测概率（%）</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">results</span> = model_GaussianNB.predict_proba(x) * <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">100</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 将预测概率转换为 DataFrame</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">results_df</span> = pd.DataFrame(np.around(results, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">2</span>), <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">columns=['非会员概率',</span> '会员概率'])

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 将预测概率添加到原数据集中最后一列</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">df_merged</span> = pd.concat([df.drop(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"用户是否为会员"</span>, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">axis=1),</span> results_df['会员概率']], <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">axis=1)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 输出前 20 列</span>
print(df_merged.head(<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">20</span>))
</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们可以看到，原 DataFrame 最后一列已经添加了我们预测某位用户是潜在会员用户的概率。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/E34B633964C2FE98DEAB9E08C11C37D1.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="840" height="493"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们可以针对概率排序，将大于&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">50%</code>&nbsp;的用户筛选出来，对这些潜在会员用户给予重点关照。^ ^</p><h2 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">人工神经网络</h2><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">除了使用高斯贝叶斯分类器，我们还可以使用人工神经网络来进行预测，人工神经网络同样可以返回概率值。关于人工神经网络的结构，我们在第 5 节分类与预测的课程中已经做过介绍，这里直接使用 sklearn 提供的神经网络模型。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">同样，我们首先拿&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">user_fit.xlsx</code>&nbsp;看一看神经网络模型的分类效果。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs python" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;"><span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> pandas as pd
from sklearn.model_selection <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> train_test_split
from sklearn.neural_network <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> MLPClassifier

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用 Pandas 读取数据</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">df</span> = pd.read_excel(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"user_fit.xlsx"</span>, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">header=0)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 特征</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">x</span> = df.iloc[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>:<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">8</span>]

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 目标</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">y</span> = df['用户是否为会员']

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 安装 3:7 切分验证集和训练集</span>
train_x, test_x, train_y, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">test_y</span> = train_test_split(x, y, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">test_size=0.3)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 构建神经网络分类器</span>

<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">model_MLPClassifier=</span> MLPClassifier(<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">activation='logistic',max_iter=50,hidden_layer_sizes=(50,50,50))</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用训练集训练模型</span>
model_MLPClassifier.fit(train_x, train_y)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用验证集评估准确度</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">score_trainset</span> = model_MLPClassifier.score(train_x, train_y)*<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">100</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">score_testset</span> = model_MLPClassifier.score(test_x, test_y)*<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">100</span>

print(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"训练集预测准确率: %.2f%%"</span> % score_trainset)
print(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"测试集预测准确率: %.2f%%"</span> % score_testset)
</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">这里，我们使用最常见的&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">logistic</code>&nbsp;激活函数，建立一个含<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">3</code>&nbsp;个隐含层，每层&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">50</code>个神经元的网络。由于迭代次数较多，在线上实验环境中运行时间较长，你也可以调低数值用于测试。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">运行得到的结果如下：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/4854BF65C9B2C3404D42DF331BF3DC31.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="444" height="67"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">结果会比上面的贝叶斯分类器好一些，但效果依旧不是最理想的情况。原因是，实验楼的确有部分用户刚注册不久就直接购买了会员服务，对于这类用户群，使用本实验的方法很难进行有效预测。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">同样，我们使用全部数据进行训练，对非会员数据进行概率预测：</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs python" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;"><span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> pandas as pd
<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> numpy as np
from sklearn.model_selection <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> train_test_split
from sklearn.neural_network <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> MLPClassifier

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用 Pandas 读取数据</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">df</span> = pd.read_excel(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"user_fit.xlsx"</span>, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">header=0)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 训练特征</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">x</span> = df.iloc[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>:<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">8</span>]

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 训练目标</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">y</span> = df['用户是否为会员']

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 读取预测数据</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">df_pre</span> = pd.read_excel(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"user_prediction.xlsx"</span>, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">header=0)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 预测特征</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">predict_x</span> = df_pre.iloc[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>:<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">8</span>]

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 构建模型</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">model_MLPClassifier=</span> MLPClassifier(<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">activation='logistic',max_iter=50,hidden_layer_sizes=(50,50,50))</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用训练集训练模型</span>
model_MLPClassifier.fit(x, y)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 返回预测概率（%）</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">results</span> = model_MLPClassifier.predict_proba(predict_x) * <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">100</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 将预测概率转换为 DataFrame</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">results_df</span> = pd.DataFrame(np.around(results, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">2</span>), <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">columns=['非会员概率',</span> '会员概率'])

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 将预测概率添加到原数据集中最后一列</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">df_merged</span> = pd.concat([df_pre.drop(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"用户是否为会员"</span>, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">axis=1),</span> results_df['会员概率']], <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">axis=1)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 按会员概率降排序，并输出前 20 列</span>
print(df_merged.sort_values(<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">by='会员概率',ascending=False).head(20))</span>
</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/2E3ACD0AC2BC97E31438D65FE5E69CF2.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1110" height="682"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们也发现，使用神经网络预测返回的概率值，没有出现像贝叶斯模型返回 100% 概率的情况，结果相对要更合理一些。</p><h2 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">实验总结</h2><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">本章节，我们通过使用 sklearn 提供的朴素贝叶斯和神经网络方法，构建了较为简单的购买会员行为预测模型。由于我们的数据集是典型可用于监督学习的数据集，这里就采用了分类的方式完成。当然，由于这种行为预测的方法十分简单，或许实际使用情况并不会特别理想。实际生产环境中，如果想要得到更为准确的行为预测结果，可能需要多种算法交叉预测。例如，可以再引入时间序列预测方法，采样分析用户从注册到购买会员期间期间的行为变化。当然，这可能需要处理 GB 量级的数据，本课程就不再深入展开了。总之，数据分析没有唯一的方案，只有根据实际数据情况不断调整，得到更好的方案。</p></div></div>
      <script>document.body.onkeyup = function(e) {
if (e.keyCode === 39) window.location.href = '十四、实验楼用户评论文本情感分析.html';
}</script>
    </body>
    </html>
  