
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="nav"><div>Next: <a href='七、寻找异常值(挑战).html'>七、寻找异常值(挑战)</a>, Previous: <a href='九、聚类分析.html'>九、聚类分析</a>, Up: <a href='index.html'>Index</a></div></div>
      <div id="titlearea">
        <h2>八、分类与预测</h2>
      </div>
      <div id="contentarea"><div class="cell text-cell"><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">本实验为实验楼训练营课程 《Python 数据分析入门与进阶》的第五节，在该章节中我们将谈论数据分析过程中遇到的分类问题。</p><h2 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">知识点</h2><ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; padding-left: 2em; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><li style="box-sizing: border-box;">线性和非线性分类</li><li style="box-sizing: border-box; margin-top: 0.25em;">支持向量机</li><li style="box-sizing: border-box; margin-top: 0.25em;">决策树</li><li style="box-sizing: border-box; margin-top: 0.25em;">随机森林</li><li style="box-sizing: border-box; margin-top: 0.25em;">神经网络</li></ul><h2 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">分类问题概述</h2><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">前面，我们已经讨论了关于数据预处理的一些细节。而在数据分析实战中，我们面对的一项重要工作，就是对数据进行分类。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">举个例子，如果你拿到了一份来自电力部门的数据集，里面包含了一个城市的个人及企业每个月的用电数据，缴费数据等。我们就可以使用这份数据去对个人用户进行信用评估分类，调整不同类别用户的电卡授信额度，对高概率拖欠电费用户每月进行短信催缴提醒。我们也可以对企业用电进行分析，根据用电量和用电时段进行分类，然后做一些保障性供电的方案。这里面就涉及到大量的数据分类应用。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">除此之外，像深度学习中会遇到的图像识别也是分类问题的应用。判断一张照片中的主体是猫还是狗？这都是典型的分类问题。生活中，像上面例子的情况还非常之多，几乎每个行业都会面临大量需要分类的问题。分类问题也是我们在数据分析中，遇到频率最高的问题。</p><h3 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; font-size: 1.25em; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">程序如何进行一个简单分类？</h3><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">在讨论各种分类方法前，我想先讨论一个可以帮助入门用户的问题，那就是程序如何进行一个简单的分类？</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">首先，我们回想一下人是如何在生活中完成事物分类的。例如区分房子和车？其实，当我们人在区分事物时，一般是抓住了一个或多个<span style="box-sizing: border-box; font-weight: 600;">特征</span>。例如，车有轮子、金属外壳、挡风玻璃等。所以，特征是对事物分类的关键要素。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">当程序在进行分类是，它也是抓住了<span style="box-sizing: border-box; font-weight: 600;">特征</span>，只是这里的特征和我们所看到的特征有一些区别。一般情况下，我们看到的是图像，而程序看到的是数值。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">如果我们想让程序来区分房子和车，最简单的方法就是先确定它们具有的共同特征。例如，物体都包含长度和高度。然后，我们让程序记录下一些数据（训练数据）。</p><table style="box-sizing: border-box; background-color: rgb(249, 249, 249); display: block; width: 359px; overflow: auto; word-break: keep-all; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><thead style="box-sizing: border-box;"><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top-color: rgb(198, 203, 209);"><th style="box-sizing: border-box; border-color: rgb(223, 226, 229);">类别</th><th align="center" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">长度（米）</th><th align="right" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">高度（米）</th></tr></thead><tbody style="box-sizing: border-box;"><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top-color: rgb(198, 203, 209);"><td style="box-sizing: border-box; border-color: rgb(223, 226, 229);">房1</td><td align="center" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">53</td><td align="right" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">92</td></tr><tr style="box-sizing: border-box; background-color: rgb(246, 248, 250); border-top-color: rgb(198, 203, 209);"><td style="box-sizing: border-box; border-color: rgb(223, 226, 229);">房2</td><td align="center" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">41</td><td align="right" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">56</td></tr><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top-color: rgb(198, 203, 209);"><td style="box-sizing: border-box; border-color: rgb(223, 226, 229);">房3</td><td align="center" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">62</td><td align="right" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">87</td></tr><tr style="box-sizing: border-box; background-color: rgb(246, 248, 250); border-top-color: rgb(198, 203, 209);"><td style="box-sizing: border-box; border-color: rgb(223, 226, 229);">车1</td><td align="center" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">2.5</td><td align="right" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">1</td></tr><tr style="box-sizing: border-box; background-color: rgb(255, 255, 255); border-top-color: rgb(198, 203, 209);"><td style="box-sizing: border-box; border-color: rgb(223, 226, 229);">车2</td><td align="center" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">3</td><td align="right" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">1.2</td></tr><tr style="box-sizing: border-box; background-color: rgb(246, 248, 250); border-top-color: rgb(198, 203, 209);"><td style="box-sizing: border-box; border-color: rgb(223, 226, 229);">车3</td><td align="center" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">3.2</td><td align="right" style="box-sizing: border-box; border-color: rgb(223, 226, 229);">1.5</td></tr></tbody></table><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">然后，我们现在有一个未知物体，它的宽度为&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">30</code>，高度为&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">40</code>。让程序判断到底是车？还是房子？</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">程序可以将训练数据的长度看作&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">X</code>&nbsp;坐标，高度看作&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">Y</code>坐标。然后将这些数据映射到&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">2</code>&nbsp;维平面空间中去。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/4A9017B1EE4D8F4AD3C06ECEFA7DEFA1.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="647" height="337"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">接下来，程序可能会用到一种叫线性分类的方法，也就是通过一条直线去划分训练数据。比如下面这条直线。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/09235D47AD3F6E670138F4B1B11A6A0A.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="647" height="337"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">红色直线上方的区域为房子，而下方为汽车。于是，当我们去判断一个新的物体时，我们就可以将其坐标落向该平面，最终得到它的分类。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/C525760EF923EE3FD1E0E1F7D8D7FE3E.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="647" height="337"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">现在，这个新物体的坐标落在了房子的区域，程序最终会将此物体分类为房子。</p><h3 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; font-size: 1.25em; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">程序完成分类具备的要素</h3><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">通过上面的介绍，我们已经对分类问题有了初步的认识。于是，我们总结一下程序完成分类所具备的要素：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><span style="box-sizing: border-box; font-weight: 600;">1. 训练数据。</span>训练数据是程序完成分类的参考依据，必不可少。我们人在用观察完成分类时，训练数据其实就是依靠着记忆。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><span style="box-sizing: border-box; font-weight: 600;">2. 分类算法。</span>分类算法，其实就是那一条「红线」的位置，它决定了落上去的新事物类别。在上面的线性分类中，我们用直线划分区域。我们也可以用曲线，甚至在高维空间中用曲面划分区域。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">有了这两点之后，我们就可以进行分类了。</p><h2 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">分类问题划分</h2><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">在了解分类算法前，我们先总结一下常见的分类方法。对于二维平面来讲，一般情况下，我们面临的分类问题有两大类：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><span style="box-sizing: border-box; font-weight: 600;">1. 二分类问题。</span>二分类，故名思意就是只存在两个类别。例如：红和蓝、猫和狗等。针对这类问题，我们可以通过一条直线划分（线性分类），或者一条曲线划分（非线性分类）。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/0D2E36885C814EBCCB38EA7180BAD4C5.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1052" height="400"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><span style="box-sizing: border-box; font-weight: 600;">2. 多分类问题。</span>多分类，即存在多个类别。那么，我们可以用多条直线，或者多条曲线完成分类。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/65492446A0C584F25F653A89D7DE40BB.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="933" height="315"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">如果特征映射突破二维，进入三维甚至更高维度。我们就只能用超平面或者超曲面完成分类。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/D16A1142D0CC03764F3D7E628C4EAF3B.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="489" height="402"></p><h2 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">常见的分类算法</h2><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">有了上面的基础知识，我们就可以正式开始学习分类算法了。学习之前，请先下载数据并解压：</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs bash" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;">wget http:<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);">//labfile.oss.aliyuncs.com/courses/764/data05.zip</span>

# 解压
unzip data05.zip
.
├── los.<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">csv</span>
├── one_class_data.<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">csv</span>
├── three_class_data.<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">csv</span>
├── two_class_data.<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">csv</span>
├── two_class_data_normal.<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">csv</span>
└── zoo.<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">csv</span>
</code></pre><h3 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; font-size: 1.25em; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">感知机</h3><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">感知机是我们要介绍的第一种分类算法。感知机是&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">1957</code>&nbsp;年就被提出来的算法，他是后面要介绍的神经网络以及支持向量机的基础。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">感知机的结构非常简单，我们这里通过对它的几何介绍来认识感知机。感知机及像我们上面提到的车和房的分类例子，通过&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">w*x + b = 0</code>&nbsp;这样一条直线将二维空间划分为两个区域，落在这两个区域中的点被归为正类和负类。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/E45CDD94D9290DFB034ACCFB3C5DC8DA.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="457" height="377"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">有人可能会疑惑，如上图所示，划分两个区域的直线可能有多条，那么感知机会选取哪一条直线呢？</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/8154B7AD8A74264A5A1EADA878BD320D.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="457" height="377"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">这就要谈到学习算法的学习策略了。感知机的学习策略是通过极小化下面的损失函数来选取最终的直线：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/531F7ED8BA5A6D241B42132DB1931A86.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="945" height="82"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">该损失函数表达的含义是误分类点到分离平面的总距离和。也就是说，误分类点越少越好，误分类点里分离平面的总距离和越小越好。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">下面，我们动手实现感知机分类模型：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们先导入一个示例数据集，然后画出该数据集的图像。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs python" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;">
from matplotlib <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> pyplot <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">as</span> plt
<span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> pandas <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">as</span> pd

# 读取数据
<span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span> = pd.read_csv(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"two_class_data.csv"</span>, header=<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>)

# 读取数据列
x = <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span>[<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">'x'</span>]
y = <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span>[<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">'y'</span>]
c = <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span>[<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">'class'</span>]

# 绘制散点图，c 参数用于分类着色
plt.scatter(x, y, c=c)
plt.show()

</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们可以看到，该数据集是一个拥有明显二分类特征的数据集。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/9914E2A6B464F63AF5BD479C274C885F.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="460" height="342"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">接下来，使用&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">Scikit-learn</code>提供的感知机方法来对上面的数据集进行分类效果测试。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">执行命令行安装<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">sklearn</code>:</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs " style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;"><span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);">$</span><span class="bash" style="box-sizing: border-box;"> sudo pip3 install sklearn</span>
</code></pre><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs python" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;">
from matplotlib <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> pyplot as plt
<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> pandas as pd
from sklearn.model_selection <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> train_test_split
from sklearn.linear_model <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> Perceptron

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 导入数据</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span> = pd.read_csv(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"two_class_data.csv"</span>, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">header=0)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 定义特征变量和目标变量</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">feature</span> = data[['x', 'y']].values
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">target</span> = data['class'].values

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 对数据集进行切分，70% 为训练集，30% 为测试集。</span>
x_train, x_test, y_train, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">y_test</span> = train_test_split(feature, target, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">test_size=0.3,</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">random_state=50)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 构建模型</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">model</span> = Perceptron()

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 训练模型</span>
model.fit(x_train, y_train)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 预测</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">results</span> = model.predict(x_test)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 以默认样式绘制训练数据</span>
plt.scatter(x_train[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>], x_train[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>], <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">alpha=0.3)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 以方块样式绘制测试数据</span>
plt.scatter(x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>], x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>], <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">marker=',',</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">c=y_test)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 将预测结果用标签样式标注在测试数据左上方</span>
for i, txt <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">in</span> enumerate(results):
    plt.annotate(txt, (x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>][i], x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>][i]))

plt.show()

</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们可以看到，测试集中有两个数据被错误分类。绿色的方框被标记为了 C2。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/1D86F751743912457D2920CF65DABF48.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1440" height="714"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">除了看图，当然可以直接导出我们的分类评估数据：</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs python" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;">
print(<span class="hljs-name" style="box-sizing: border-box; color: rgb(249, 38, 114);">model</span>.score(<span class="hljs-name" style="box-sizing: border-box; color: rgb(249, 38, 114);">x_test</span>, y_test))

</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">结果显示，使用验证集的正确分类率为：<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">0.990196078431</code>。&nbsp;<img src="resources/05128AB0985C95C612534A1A6E05340F.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="735" height="38"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">当然，这里如此高的分类正确率，很大程度是因为我们给的示例数据很好。感知机作为一种十分基础的分类方法，在实际数据分类和预测中并不常用。因为，实战过程中的数据肯定没有示例数据呈现出的线性可分性。不信的话，可以拿示例数据中的&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">two_class_data_normal.csv</code>数据文件再试一下。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">当然，这并不意味着感知机不重要。理解感知机，可以帮助我们更好地理解后面的支持向量机算法和神经网络算法。</p><h3 id="-svm-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; font-size: 1.25em; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">支持向量机（SVM）</h3><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">支持向量机是一种非常常用，适用性非常广的分类方法。与感知机不同的是，支持向量机不仅可以用于线性分类，还可以用于非线性分类。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">支持向量机由&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">Vapnik</code>&nbsp;于&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">1963</code>年提出，与感知机不同的地方在于，支持向量机引入了「最大间隔」的思想来划定分割平面。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">这里所说的「最大间隔」如下图所示。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/A131B5DF30B6856332A653ED054654A2.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="438" height="258"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">对于上图所示的黑点和白点两个类别而言，我们通过寻找距离两种类别间隔最大的平面&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">w*x-b=0</code>&nbsp;来作为分割平面。其中，实线与两条虚线的距离相等，且最大。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">落在两条虚线上的白点或黑点被我们称之为「支持向量」，这也就是支持向量机的名字来源。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">现在，我们通过支持向量机来重新对刚刚使用感知机达到&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">99%</code>&nbsp;的&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">two_class_data.csv</code>&nbsp;进行重新分类：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">你只需要更改两行代码，分别是导入支持向量机&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">SVC</code>&nbsp;和使用&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">SCV</code>&nbsp;构建模型。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs python" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;">
from matplotlib <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> pyplot as plt
<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> pandas as pd
from sklearn.model_selection <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> train_test_split
<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 导入支持向量机</span>
from sklearn.svm <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> SVC

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 导入数据</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span> = pd.read_csv(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"two_class_data.csv"</span>, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">header=0)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 定义特征变量和目标变量</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">feature</span> = data[['x', 'y']].values
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">target</span> = data['class'].values

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 对数据集进行切分，70% 为训练集，30% 为测试集。</span>
x_train, x_test, y_train, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">y_test</span> = train_test_split(feature, target, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">test_size=0.3,</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">random_state=50)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 构建模型</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">model</span> = SVC()

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 训练模型</span>
model.fit(x_train, y_train)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 预测</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">results</span> = model.predict(x_test)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 以默认样式绘制训练数据</span>
plt.scatter(x_train[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>], x_train[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>], <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">alpha=0.3)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 以方块样式绘制测试数据</span>
plt.scatter(x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>], x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>], <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">marker=',',</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">c=y_test)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 将预测结果用标签样式标注在测试数据左上方</span>
for i, txt <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">in</span> enumerate(results):
    plt.annotate(txt, (x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>][i], x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>][i]))

plt.show()

</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">测试结果如下：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/8E6DEC37443B56337AECC5B41B0814AF.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1382" height="689"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">此时，分类正确率已经到达&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">100%</code>。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">除了线性分类，支持向量机还通过引入核函数来解决非线性分类的问题。我们依旧从几何角度来解释：&nbsp;<img src="resources/577B398466A4AE4D0FE678F5D08459A0.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="723" height="158"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">上面这三张图片演示了支持向量机解决非线性分类的过程。第一张中，红色小球和蓝色小球无法使用一条直线完成分类，于是我们通过核技巧将其映射到三维空间中（第二张），然后通过绿色的平面完成分类。最终再投影到二维空间中，平面投影下来就变成了一条曲线。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">在将特征映射到高维空间的过程中，我们常常会用到多种核函数，包括：线性核函数、多项式核函数、高斯径向基核函数等。其中，最常用的就算是高斯径向基核函数了，也简称为&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">RBF</code>&nbsp;核。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">下面，我们通过支持向量机完成一个非线性分类的任务。这里的示例数据&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">zoo.csv</code>来源于 UCI 数据网站。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">zoo.csv</code>&nbsp;叫动物园数据集，总共有 18 列，第一列为动物名称，最后一列为动物分类。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/C9435371FEDB9BA5BF52BC30641EAC62.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1269" height="147"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">数据集中间的&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">16</code>列为动物的特征，比如：是否有毛发、是否下蛋等。除了腿的数量为数值型，其余特征列均为布尔型数据。数据集中的动物共有&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">7</code>类，通过最后一列的数字表示。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">接下来，我们尝试通过支持向量机完成这一个非线性的多分类任务。第一步依旧是导入&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">csv</code>数据文件。然后定义其中&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">16</code>&nbsp;列为特征，最后一列为目标值。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs " style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;"><span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> pandas <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">as</span> pd
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">from</span> sklearn.model_selection <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> train_test_split
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">from</span> sklearn.svm <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> SVC
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">from</span> sklearn.decomposition <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> PCA


<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 导入数据</span>
<span class="hljs-class" style="box-sizing: border-box;"><span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span> = pd.read_csv('<span class="hljs-title" style="box-sizing: border-box;">zoo</span>.<span class="hljs-title" style="box-sizing: border-box;">csv'</span>, <span class="hljs-title" style="box-sizing: border-box;">header</span>=0)</span>

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 定义特征变量和目标变量</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">feature</span> = <span class="hljs-class" style="box-sizing: border-box;"><span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span>.iloc[:, 1:17].values</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">target</span> = <span class="hljs-class" style="box-sizing: border-box;"><span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span>['<span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">type</span>'].values</span>

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 对数据集进行切分，70% 为训练集，30% 为测试集。</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">x_train</span>, x_test, y_train, y_test = train_test_split(feature, target, test_size=<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0.3</span>, random_state=<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">50</span>)

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 构建模型</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">model</span> = <span class="hljs-type" style="box-sizing: border-box; color: rgb(230, 219, 116);">SVC</span>()

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 训练模型</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">model</span>.fit(x_train, y_train)

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 预测</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">results</span> = model.predict(x_test)

<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">print</span>(model.score(x_test, y_test))
</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们测试集的正确分类率为 0.867：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/437C427E62265386594C756951C75F8D.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="714" height="63"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们有&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">16</code>个特征参与运算，但是得出的正确率并不高。其中一个主要原因为，这里的数据集太小了，总共才&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">100</code>&nbsp;行。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">由于存在&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">16</code>&nbsp;个特征，所以无法进行可视化。下面，介绍一种叫做&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">PCA`</code>&nbsp;降维的方法，它的作用是缩减特征的数量，从而更方便可视化呈现。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs " style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;"><span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">from</span> matplotlib <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> pyplot <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">as</span> plt
<span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> pandas <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">as</span> pd
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">from</span> sklearn.model_selection <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> train_test_split
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">from</span> sklearn.svm <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> SVC
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">from</span> sklearn.decomposition <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> PCA


<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 导入数据</span>
<span class="hljs-class" style="box-sizing: border-box;"><span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span> = pd.read_csv('<span class="hljs-title" style="box-sizing: border-box;">zoo</span>.<span class="hljs-title" style="box-sizing: border-box;">csv'</span>, <span class="hljs-title" style="box-sizing: border-box;">header</span>=0)</span>

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 定义特征变量和目标变量</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">feature</span> = <span class="hljs-class" style="box-sizing: border-box;"><span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span>.iloc[:, 1:17].values</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">target</span> = <span class="hljs-class" style="box-sizing: border-box;"><span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span>['<span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">type</span>'].values</span>

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 使用 PCA 降维至 2</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">pca</span> = <span class="hljs-type" style="box-sizing: border-box; color: rgb(230, 219, 116);">PCA</span>(n_components=<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">2</span>)
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">feature_pca</span> = pca.fit_transform(feature)


<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 对数据集进行切分，70% 为训练集，30% 为测试集。</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">x_train</span>, x_test, y_train, y_test = train_test_split(feature_pca, target, test_size=<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0.3</span>, random_state=<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">50</span>)

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 构建模型</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">model</span> = <span class="hljs-type" style="box-sizing: border-box; color: rgb(230, 219, 116);">SVC</span>()

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 训练模型</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">model</span>.fit(x_train, y_train)

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 预测</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">results</span> = model.predict(x_test)

<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">print</span>(model.score(x_test, y_test))

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 以默认样式绘制训练数据</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">plt</span>.scatter(x_train[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>], x_train[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>], alpha=<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0.3</span>)

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 以方块样式绘制测试数据</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">plt</span>.scatter(x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>], x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>], marker=',', c=y_test)

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 将预测结果用标签样式标注在测试数据左上方</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">for</span> i, txt <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">in</span> enumerate(results):
    plt.annotate(txt, (x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>][i], x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>][i]))

<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">plt</span>.show()

</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">当特征降为<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">2</code>维时，我们就可以通过平面图画出来了。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/DFE4BE1202F33938C2256AABE074FB8F.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1382" height="689"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/23CBFA8AB7249D65B826BFBABF9C89EE.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="690" height="69"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">你可能会纳闷，这里得出的准确度竟然变成了&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">0.833</code>，比先前的&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">0.867</code>&nbsp;还要低。究其原因，当然是我们的特征数量减少了，这可能会影响到准确度。</p><h2 id="k-knn-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">K-近邻法（KNN）</h2><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">K 近邻是一种十分常用的分类方法。对于&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">KNN</code>，我们依旧通过一张几何图像来解释：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/1DD49B9E79470E99A36CCC835241A023.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="384" height="288"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们的数据集如上图所示的 A 类和 B 类。现在，我们新输入一个数据（五角星），要判断该数据属于哪一个类？</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">KNN 的方法是以该数据为圆心，画一个圆。圆的半径不确定，可大可小。当它为图示中的内圆时，B 类数据多余 A 类，所以五角星数据属于 B 类。当为大圆时，A 类数据多于 B 类，所以五角星属于 A 类。而圆的大小，取决于 K 值。而 K 指的是与新数据最近邻的 K 个值。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">于是，我们总结一下&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">KNN</code>中的三个关键要素：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><span style="box-sizing: border-box; font-weight: 600;">1. K 值的大小。</span><code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">K</code>&nbsp;值一般通过测试数据交叉验证来选择。&nbsp;<span style="box-sizing: border-box; font-weight: 600;">2. 距离的度量。</span>新数据与最近邻数据之间的距离计算方式，有欧式距离或者曼哈顿距离等。<span style="box-sizing: border-box; font-weight: 600;">3. 分类决策规则。</span><code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">KNN</code>&nbsp;的决策规则为多数表决，即新数据属于圆圈中占比最大的一类。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">这一次，我们使用一个由<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">3</code>种类别构成的数据集&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">three_class_data.csv</code>测试，并将<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">KNN</code>的决策边界绘制出来。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs " style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;">from matplotlib <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> pyplot as plt
from matplotlib.colors <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> ListedColormap

<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> pandas as pd
<span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> numpy as np
from sklearn.model_selection <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> train_test_split
from sklearn.neighbors <span class="hljs-built_in" style="box-sizing: border-box; color: rgb(230, 219, 116);">import</span> KNeighborsClassifier

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 导入数据</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span> = pd.read_csv('three_class_data.csv', <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">header=0)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 定义特征变量和目标变量</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">feature</span> = data[['x', 'y']].values
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">target</span> = data['class'].values

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 对数据集进行切分，70% 为训练集，30% 为测试集。</span>
x_train, x_test, y_train, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">y_test</span> = train_test_split(feature, target, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">test_size=0.3,</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">random_state=50)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 构建模型</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">model</span> = KNeighborsClassifier()

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 训练模型</span>
model.fit(x_train, y_train)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 预测</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">results</span> = model.predict(x_test)

print(model.score(x_test, y_test))

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 绘制决策边界等高线图</span>
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">cm0</span> = plt.cm.Oranges
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">cm1</span> = plt.cm.Greens
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">cm2</span> = plt.cm.Reds
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">cm_color</span> = ListedColormap(['red', 'yellow'])

x_min, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">x_max</span> = data['x'].min() - .<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">5</span>, data['x'].max() + .<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">5</span>
y_min, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">y_max</span> = data['y'].min() - .<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">5</span>, data['y'].max() + .<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">5</span>

xx, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">yy</span> = np.meshgrid(np.arange(x_min, x_max, .<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>),
                     np.arange(y_min, y_max, .<span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>))

<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">Z0</span> = model.predict_proba(np.c_[xx.ravel(), yy.ravel()])[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>]
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">Z1</span> = model.predict_proba(np.c_[xx.ravel(), yy.ravel()])[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>]
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">Z2</span> = model.predict_proba(np.c_[xx.ravel(), yy.ravel()])[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">2</span>]

<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">Z0</span> = Z0.reshape(xx.shape)
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">Z1</span> = Z1.reshape(xx.shape)
<span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">Z2</span> = Z2.reshape(xx.shape)

plt.contourf(xx, yy, Z0, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">cmap=cm0,</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">alpha=.9)</span>
plt.contourf(xx, yy, Z1, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">cmap=cm1,</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">alpha=.5)</span>
plt.contourf(xx, yy, Z2, <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">cmap=cm2,</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">alpha=.4)</span>

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 绘制训练集和测试集</span>
plt.scatter(x_train[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>], x_train[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>], <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">c=y_train,</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">cmap=cm_color)</span>
plt.scatter(x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">0</span>], x_test[:, <span class="hljs-number" style="box-sizing: border-box; color: rgb(174, 129, 255);">1</span>], <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">c=y_test,</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">cmap=cm_color,</span> <span class="hljs-attr" style="box-sizing: border-box; color: rgb(249, 38, 114);">edgecolors='black')</span>
plt.show()

</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">由于示例数据集界线清晰，所以分类的正确率为 100%。我们主要是看一下 KNN 的决策边界：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/B11CE36286157D9E8929FAE8AD7C2B96.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="460" height="342"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">图中，颜色越深的地方代表属于某一类别的可能性越高。</p><h3 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; font-size: 1.25em; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">决策树和随机森林</h3><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">除了支持向量机和&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">KNN</code>之外，决策树和随机森林也是非常不错的分类方法。如果你没有听说过随机森林，就把它当作是用决策树组成的森林就好了。所以这里，我们会将两种方法放在一起介绍。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">决策树理解起来非常简单，义务教育阶段其实就已经接触过决策树的概念了。在决策分析中，我们可以用一棵决策树可以形象地展示决策过程，而决策树中，就类似于&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">if-then</code>&nbsp;规则的集合。例如，我们用下面的决策树来区分西瓜的好与坏：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/C81CDDDDE901A600932FDE7B87E7A035.jpg" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="540" height="415"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">在用决策时进行分类时，我们从跟节点出发，对实例的特征进行测试，然后将其分别分给不同的子节点。然后对子节点重复上面的步骤，使得最终所有的实例被分给叶节点中。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">执行决策树算法，一般分为三步：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><span style="box-sizing: border-box; font-weight: 600;">1. 特征选项。</span></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">特性选择及选择判断规则。例如上面判断西瓜好坏的决策树中，我们的特征为触感、敲声。特征选择是决策树建立前完成的工作，它决定了决策树的最终形状。一般情况下，我们依据<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">3</code>种指标来选择特征，分别是信息增益、信息增益比、以及基尼指数。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">其中，依据信息增益来选择特征，是一种来源于信息论和概率统计中的方法。我们通过判断某一特征对决策树前后影响的信息差值，从而选出最关键的特征。这种依据信息增益来选择特征的算法，也被称作&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">ID3</code>&nbsp;算法。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">后来，我们发现信息增益在划分训练数据特征时，容易偏向取值较多的特征。于是，我们改进了&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">ID3</code>算法，通过信息增益比值来选择，发展出了&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">C4.5</code>算法。除此之外，还有一种叫&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">CART</code>&nbsp;的生成算法，它利用了基尼指数最小化的原则。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><span style="box-sizing: border-box; font-weight: 600;">2. 树的生成。</span></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">选择完特征之后，我们就通过这些特征来生成一颗完整的决策树。生成的原则是，所有训练数据都能分配到相应的叶节点。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><span style="box-sizing: border-box; font-weight: 600;">3. 树的剪枝。</span></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">一颗完整的决策树，使得训练数据得到有效的划分。但是，你会发现完整的决策树往往对于测试数据的效果并不好。这就出现了过度拟合的问题。过度拟合，指模型对训练数据的效果很好，但是对测试数据的效果差，泛化能力较弱。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">解决决策树过度拟合的方法是对决策树进行剪枝。剪枝，也就是去掉一些叶节点。剪枝并不是随意乱剪，它的依据是，剪枝前和剪枝后的决策树整体损失函数最小。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">对于决策树的演示，我们用到了著名的鸢尾花&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">iris</code>&nbsp;数据集。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">iris</code>是机器学习领域一个非常经典的分类数据集，它总共包含<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">150</code>行数据。每一行数据由<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">4</code>&nbsp;个特征值及一个目标值组成。其中&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">4`</code>&nbsp;个特征值分别为：萼片长度、萼片宽度、花瓣长度、花瓣宽度。而目标值及为三种不同类别的鸢尾花，分别为：<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">Iris Setosa，Iris Versicolour，Iris Virginica</code>。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">iris 数据集无需导入 csv 文件，作为常用的基准数据集之一，<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">sklearn</code>&nbsp;提供了相应的导入方法。如果你对该数据集不太熟悉，可以先输出数据看一看。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs python" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;"><span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">from</span> sklearn <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> datasets

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 载入数据集</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">iris</span> = datasets.load_iris()

<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">print</span>(iris.<span class="hljs-class" style="box-sizing: border-box;"><span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span>, iris.target)</span>
</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/99BBA893E8C41661075FFD8FDD23F67B.jpg" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1126" height="639"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">接下来，我们构建 iris 分类决策树。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs python" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;"><span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">from</span> sklearn.datasets <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> load_iris
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">from</span> sklearn <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">import</span> tree

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 导入数据</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">iris</span> = load_iris()

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 建立模型</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">model</span> = tree.<span class="hljs-type" style="box-sizing: border-box; color: rgb(230, 219, 116);">DecisionTreeClassifier</span>()

<span class="hljs-meta" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 模型训练</span>
<span class="hljs-title" style="box-sizing: border-box; color: rgb(166, 226, 46);">clf</span> = model.fit(iris.<span class="hljs-class" style="box-sizing: border-box;"><span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">data</span>, iris.target)</span>
</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">完成模型训练，其实就建立起一颗决策树了。然后，这里我们通过&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">graphviz</code>&nbsp;模块，将决策树绘制出来。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">首先在实验楼<span style="box-sizing: border-box; font-weight: 600;">在线环境安装该模块</span>：</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs bash" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;">sudo apt-get <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">install</span> graphviz

sudo /home/shiyanlou/anaconda3/<span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">bin</span>/pip <span class="hljs-keyword" style="box-sizing: border-box; color: rgb(249, 38, 114);">install</span> graphviz
</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">接下来绘制决策树。由于在线环境限制，我们可以将其保存为<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">pdf</code>文件。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs python" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;">import graphviz

dot_data = tree.export_graphviz(clf, out_file=None) 
graph = graphviz.Source(dot_data) 

graph.render(<span class="hljs-string" style="box-sizing: border-box; color: rgb(230, 219, 116);">"iris"</span>) 
</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/4056C6F060EF09D7269E2F8CFECF5D70.jpg" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1191" height="183"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">到主目录下找到该文件，然后选择火狐浏览器打开。我们就可以看到决策树是如何分类鸢尾花的了。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/024738688DC907350AD298FD1CAB657C.jpg" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1468" height="1079"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">如果你在线下使用 jupyter notebook 来完成，可以绘制出更漂亮、直观的图像。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/E6EF6983F393AF4EA57A5114FD5C6347.jpg" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1343" height="1223"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">随机森林与决策树不同的地方在用，它不只是建立一颗树，而是建立一堆树。与决策树不同，随机森林每次只从全部数据集中随机抽取一部分数据用于生成树。另外，随机森林在生成树的时候不会剪枝。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/6740332F4C0E3A074854DD7725671082.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="567" height="328"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">随机森林的优点多多，例如：它可以处理大量的数据；它可以在特征不均衡时，依然维持较高的准确度；随机森林学习速度快，一般情况下，结果比单纯应用决策树要好。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们分别使用随机森林和决策树算法针对上面的&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">iris</code>&nbsp;数据集进行分类，看一看准确度。</p><pre style="box-sizing: border-box; overflow: auto; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; padding: 9.5px; margin-top: 0px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; font-variant-ligatures: normal; orphans: 2; widows: 2;"><code class="hljs python" style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: inherit; padding: 0.5em; color: rgb(248, 248, 242); background-color: rgb(35, 36, 31); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; white-space: pre-wrap; word-break: break-all; display: block; overflow-x: auto;">from sklearn.datasets import load_iris
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 导入数据</span>
iris = load_iris()

x_train = iris.data[:120]
x_test = iris.data[120:]

y_train = iris.target[:120]
y_test = iris.target[120:]

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 建立模型</span>
model_tree = DecisionTreeClassifier(random_state=10)
model_random = RandomForestClassifier(random_state=10)

<span class="hljs-comment" style="box-sizing: border-box; color: rgb(117, 113, 94);"># 训练模型并验证</span>
model_tree.fit(x_train, y_train)
s1 = model_tree.score(x_test, y_test)

model_random.fit(x_train, y_train)
s2 = model_random.score(x_test, y_test)

<span class="hljs-section" style="box-sizing: border-box; color: rgb(166, 226, 46);">print('DecisionTree:', s1)</span>
<span class="hljs-section" style="box-sizing: border-box; color: rgb(166, 226, 46);">print('RandomForest:', s2)</span>

</code></pre><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">结果显示，随机森林的正确分类率比决策树高&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">10</code>个百分点。&nbsp;<img src="resources/C9E8054BD53E030BC93B3C73B64FFCFF.jpg" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1087" height="136"></p><h2 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">神经网络模型</h2><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">除了上面谈到的&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">KNN</code>，决策树，随机森林，支持向量机这些分类方法，其实还有常见的分类方法，如最大熵模型、朴素贝叶斯等。而对于这两种方法，涉及到较多的数据理论，讨论起来比较枯燥。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">最后，我们简单地介绍一下人工神经网络。因为深度学习的火爆，神经网络从而进入了更多人的视野。实际上，神经网络诞生的非常之早，早在 1943 年，沃伦·麦卡洛克和沃尔特·皮茨基于数学和一种称为阈值逻辑的算法，创造了一种神经网络的计算模型。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">人工神经网络，目前发展迅速，涉及到的变种太多。这里，我们只是简单的入门，如果要覆盖神经网络全部内容，没有几千页是不行的。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">一个含单个隐含层的人工神经网络如下所示：</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/717F4C3FC28EF17EF434739981B8855F.png" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="281" height="306"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">我们针对输入的特征，连接权重，然后得到输出。这样一个简单的结构，就构建了神经网络的拓扑关系。我们可以通过&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">sklearn</code>&nbsp;中提供的&nbsp;<code style="box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 14.4px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; word-break: break-all;">neural_network</code>&nbsp;模块导入相应的分类器来实现神经网络。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">入门神经网络，其实有一个更直观的工具。Google 提供了一个在线演示简单神经网络结构的网站&nbsp;<a href="http://playground.tensorflow.org/" target="_blank" style="box-sizing: border-box; background-color: transparent; color: rgb(3, 102, 214); text-decoration: none;">http://playground.tensorflow.org/</a>&nbsp;，你可以自己动手感受神经网络的运作过程。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);"><img src="resources/4DEA25FF02C86781524E20D34121A070.jpg" alt="此处输入图片的描述" style="box-sizing: content-box; border: 0px none; vertical-align: middle; background-color: rgb(255, 255, 255); cursor: pointer;" width="1450" height="697"></p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">你可以调整神经网络的各种参数，添加特征输入类，添加隐含层和调整神经元。</p><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">神经网络是非常强大的一种学习方法，尤其是在面对海量数据的今天，神经网络能完成许多通过传统算法无法很好完成的图像分类、语音识别的任务。</p><h2 id="-" style="box-sizing: border-box; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; line-height: 1.25; color: rgb(36, 41, 46); margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(234, 236, 239); font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">实验总结</h2><p style="box-sizing: border-box; margin: 0px 0px 16px; color: rgb(36, 41, 46); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; orphans: 2; widows: 2; background-color: rgb(249, 249, 249);">数据分析，不仅是通过统计和可视化将现有数据展示出来。除此之外，我们还要通过相应的手段和方法去发现规律，对未来趋势做出预测。这个部分，我们了解了常见的分类方法，并学习了通过 Scikit-Learn 去构建预测模型。如果，有了 pandas，matplotlib，scikit-learn 等简单易学的开源工具帮助，编程能力已经不再是数据分析的高门槛。面对数据，形成我们探索数据的思维，才是这个过程中最需要培养的部分。</p><div><br></div></div></div>
      <script>document.body.onkeyup = function(e) {
if (e.keyCode === 39) window.location.href = '七、寻找异常值(挑战).html';
if (e.keyCode === 37) window.location.href = '九、聚类分析.html';
}</script>
    </body>
    </html>
  